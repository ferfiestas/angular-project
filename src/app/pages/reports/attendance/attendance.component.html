<div class="attendance-container">
    <mat-form-field appearance="fill">
        <mat-label>Tipo de Consulta</mat-label>
        <mat-select [(value)]="consultaType">
            <mat-option value="1">Búsqueda por empleado</mat-option>
            <mat-option value="2">Buscar por comienzo de una fecha en específico</mat-option>
            <mat-option value="3">Búsqueda por rango de fechas</mat-option>
            <mat-option value="4">Búsqueda por empleado y rango de fechas</mat-option>
        </mat-select>
    </mat-form-field>

    <div *ngIf="consultaType === '1' || consultaType === '4'">
        <mat-form-field appearance="fill">
            <mat-label>Usuario</mat-label>
            <mat-select [(value)]="selectedPersona">
                <mat-option *ngFor="let persona of personas" [value]="persona">
                    {{ persona.nombre }}
                </mat-option>
            </mat-select>
        </mat-form-field>
    </div>

    <div *ngIf="consultaType === '2' || consultaType === '3' || consultaType === '4'">
        <mat-form-field appearance="fill">
            <mat-label>Fecha Inicio</mat-label>
            <input matInput [matDatepicker]="picker1" [(ngModel)]="fechaInicio" />
            <mat-datepicker-toggle matSuffix [for]="picker1"></mat-datepicker-toggle>
            <mat-datepicker #picker1></mat-datepicker>
        </mat-form-field>
    </div>

    <div *ngIf="consultaType === '3' || consultaType === '4'">
        <mat-form-field appearance="fill">
            <mat-label>Fecha Fin</mat-label>
            <input matInput [matDatepicker]="picker2" [(ngModel)]="fechaFin" />
            <mat-datepicker-toggle matSuffix [for]="picker2"></mat-datepicker-toggle>
            <mat-datepicker #picker2></mat-datepicker>
        </mat-form-field>
    </div>

    <button mat-raised-button color="primary" (click)="buscar()">Buscar</button>

    <div *ngIf="excelDataAvailable">
        <button mat-raised-button color="accent" (click)="descargarExcel()">Descargar Información</button>
    </div>
</div>